// Author: Vince Reid, vince@ecommercetemplates.com
// Copyright: Internet Business Solutions S.L.
// http://www.ibswebdesign.com
// PopOutTextMenu: v2.00
 	var ie,ns6,ns,opera,ismac; var menuid,d6,c2ref; var c1,c2,c3; var globalsdefined=false; var debugstr=""; var debug=true; function addtodebug(str){debugstr += str+', ';}; function showdebug(){if(debugstr!="")document.getElementById('debugdiv').innerHTML += debugstr+'<br>';debugstr="";}; function d3(ginfref,top,c4,sub,c9){ this.d4=ginfref; this.topitem=top; this.c4=c4; this.submenu=0; this.subitem=sub; this.c9=c9; this.d1=0; this.d2=0; this.b1=0; this.a8=0; this.a9=0; this.c7=''; this.c5=''; }; function a0(){ this.b2=0; this.b3=0; this.b4=0; this.b5=0; this.b8=0; this.b9=0; this.b7=0; this.b6=0; this.hideselect=false; this.hideobject=false; this.lasttimeoutid = 0; this.mainmenulist = new Array() }; function defineglobals(){ if(globalsdefined==true) return; ie=(document.all); ns6=(document.getElementById&&!document.all); ns=(document.layers != (void 0)); ismac=(navigator.appVersion.indexOf("Mac") != -1); opera=false; if(ie){ var agent=navigator.userAgent.toLowerCase(); opera=(agent.indexOf("opera") != -1); }; c1=new Array(); c3=new Array(); c2 = new Array(); menuid=1; d6=1; c2ref=1; }; function showrootmenu(c8){ if(ie || ns6){ mnn=document.getElementById('vrsub'+c8); mnn.style.visibility="visible"; }else if(ns){ mnn=eval('document.layers.vrsub'+c8); mnn.visibility="show"; }; }; function showhideobjects(showhide,bSelect,bObject){ if(bSelect){ for(ii=0; ii<document.all.tags("SELECT").length; ii++){ obj = document.all.tags("SELECT")[ii]; obj.style.visibility = showhide; } }; if(bObject){ for(ii=0; ii<document.all.tags("OBJECT").length; ii++){ obj = document.all.tags("OBJECT")[ii]; obj.style.visibility = showhide; } }; }; function a6(menuid,d6){ c2[c3[d6].d4].b4=menuid; while(c3[d6].topitem != 0){ if(ns){ mnn=eval('document.layers.vrsub'+c3[d6].c4); mnn.visibility="show"; }else{ mnn=document.getElementById('vrsub'+c3[d6].c4); if(mnn.style.visibility!="visible") mnn.style.visibility="visible"; } d6=c3[d6].topitem; } if(ie){ } }; function dohidemenu(mindx){ if(ns){ mnn=eval('document.layers.vrsub'+mindx); mnn.visibility="hide"; }else{ mnn=document.getElementById('vrsub'+mindx); if(mnn.style.visibility!="hidden") mnn.style.visibility="hidden"; } }; function a5(c8){  var currentitem = c2[c3[c8].d4].b5; var currentmenu = c2[c3[c8].d4].b4; for(objItem in c2[c3[c8].d4].mainmenulist){ if(currentitem==0 && currentmenu==0){ dohidemenu(c2[c3[c8].d4].mainmenulist[objItem]); }else{ var issaved=false; c4 = c2[c3[c8].d4].mainmenulist[objItem]; if(currentitem!=0){ if(c4 == c3[currentitem].c4)issaved=true; if(c4 == c3[currentitem].submenu)issaved=true; if(!issaved){ topitem = c3[currentitem].topitem; while(topitem!=0 && (! issaved)){ if(c4==c3[topitem].c4)issaved=true; topitem = c3[topitem].topitem; } } }else{ if(c4 == currentmenu)issaved=true; if(!issaved){ topitem = c3[c8].topitem; while(topitem!=0 && (! issaved)){ if(c4==c3[topitem].c4)issaved=true; topitem = c3[topitem].topitem; } } } if(! issaved)dohidemenu(c4); } } if(ie && currentitem==0){ showhideobjects("visible",c2[c3[c8].d4].hideselect,c2[c3[c8].d4].hideobject); } }; function a4(c8){ var tmi=c8; clearTimeout(c2[c3[c8].d4].lasttimeoutid); c2[c3[c8].d4].b5=c8; if(ie || ns6){ document.getElementById('td'+c8).style.backgroundColor=c3[c8].c5; } if(c3[c8].subitem != 0){ if(ie){ var mnp=eval('vrsub'+c3[c8].c4); var offsetleft=0, offsettop=0; if(ismac){ offsettop=mnp.style.pixelTop; offsetleft=mnp.style.pixelLeft; }else{ do{ offsetleft += mnp.offsetLeft; offsettop += mnp.offsetTop; mnp=mnp.offsetParent; } while (mnp != null); } mnn=eval('vrsub'+c3[c3[c8].subitem].c4); mnn.style.pixelTop=offsettop+(c3[c8].c9*c3[c8].d1)+c2[c3[c8].d4].b3; mnn.style.pixelLeft=offsetleft+c3[c8].d2+c3[c8].a9-c2[c3[c8].d4].b2; mnn.style.visibility="visible"; showhideobjects("hidden",c2[c3[c8].d4].hideselect,c2[c3[c8].d4].hideobject); }else if(ns){ mnn=eval('document.layers.vrsub'+c3[c3[c8].subitem].c4); mnp=eval('document.layers.vrsub'+c3[c8].c4); mnn.top=mnp.pageY+(c3[c8].c9*c3[c8].d1)+c2[c3[c8].d4].b3; mnn.left=mnp.pageX + mnp.clip.right-c2[c3[c8].d4].b2-c3[c8].a8; mnn.visibility="show"; for(ii=c2[c3[c8].d4].b8;ii <= c2[c3[c8].d4].b9;ii++){ if(c3[ii].subitem!=0&&c3[c8].c4==c3[ii].c4&&ii!=c8){ mnn=eval('document.layers.vrsub'+c3[c3[ii].subitem].c4); mnn.visibility="hide"; } } }else if(ns6){ mnn=document.getElementById('vrsub'+c3[c3[c8].subitem].c4); mnp=document.getElementById('vrsub'+c3[c8].c4); mnn.style.top=mnp.offsetTop+(c3[c8].c9*c3[c8].d1)+c2[c3[c8].d4].b3+"px"; mnn.style.left=mnp.offsetLeft+c3[c8].d2+c3[c8].a9-c2[c3[c8].d4].b2+"px"; mnn.style.visibility="visible"; } }; a5(c8); }; function zeroinitem(c8){ c2[c3[c8].d4].b5=0; if(ie || ns6){ document.getElementById('td'+c8).style.backgroundColor=c3[c8].c7; } }; function c6(mid, del){ clearTimeout(c2[c3[mid].d4].lasttimeoutid); c2[c3[mid].d4].lasttimeoutid = setTimeout('a5('+mid+')',del); }; function POTMenu(){ POTMenu.prototype.addMenu=function(mid,mtext,mlink){ if(c1[mid]) alert('Menu id '+mid+' is already defined.'); if(c0==true) alert('You have to define all the main menus before defining the sub menus'); d6++; c3[d6]=new d3(this.f3,0,menuid,0,this.nomenus); c3[d6].d1=this.g1+this.mainspacery; c3[d6].d2=this.g3; c3[d6].b1=this.imgheight; c3[d6].a8=this.f9; c3[d6].a9=this.f8; c3[d6].c7=this.maincbgcolor; c3[d6].c5=this.maincbgcolorov; c1[mid]=d6; this.nomenus++; if(d6>this.firstmenuitem&&this.mainspacery>0){ this.d8 += '<tr><td width="'+this.g3+'" height="'+this.mainspacery+'">'; this.d8 += '<img border="0" src="'+this.mainspacer+'" width="'+this.g3+'" height="'+this.mainspacery+'">'; this.d8 += '</td></tr>'; }; if(ie){ this.d8 += '<tr><td id="td'+d6+'" width="'+this.g3+'" height="'+this.g1+'" bgcolor="'+this.maincbgcolor+'">'; this.d8 += '<div class=menu id="imx'+d6+'" onMouseover="a4('+d6+')" onMouseout="zeroinitem('+d6+');c6('+d6+','+this.menudelay+')" STYLE="position:relative; width:'+this.g3+'; z-index: 6">'; this.d8 += '<img align="absmiddle" border="0" src="'+this.mainpreim+'" width="'+this.mainpreimx+'" height="'+this.mainpreimy+'">'; if(mlink != "") this.d8 += '<a class=menu href="'+mlink+'">'; this.d8 += mtext; if(mlink != "") this.d8 += '</a>'; this.d8 += '</div></td></tr>'; }else if(ns){ this.d8 += '<tr><td id="td'+d6+'" class=menu width="'+this.g3+'" height="'+this.g1+'" bgcolor="'+this.maincbgcolor+'">'; this.d8 += '<ilayer visibility="show"><layer width="'+this.g3+'" height="'+this.g1+'" onmouseover="a4('+d6+');" onMouseout="zeroinitem('+d6+');c6('+d6+','+this.menudelay+')">'; if(this.nnmainheight > 0) this.d8 += '<img align="textbottom" border="0" src="'+this.mainpreim+'" width="'+this.g3+'" height="'+this.nnmainheight+'"><br>'; this.d8 += '&nbsp;'; if(mlink != "") this.d8 += '<a class=menu href="'+mlink+'">'; this.d8 += mtext; if(mlink != "") this.d8 += '</a>'; this.d8 += '</layer></ilayer></td></tr>'; }else if(ns6){ this.d8 += '<tr><td id="td'+d6+'" valign="bottom" width="'+this.g3+'" height="'+this.g1+'" bgcolor="'+this.maincbgcolor+'">'; this.d8 += '<div class=menu id="noimx'+d6+'" onMouseover="a4('+d6+')" onMouseout="zeroinitem('+d6+');c6('+d6+','+this.menudelay+')" STYLE="position:relative; visibility: visible">'; this.d8 += '<img name="imx'+d6+'" align="absmiddle" border="0" src="'+this.mainpreim+'" width="'+this.mainpreimx+'" height="'+this.mainpreimy+'">'; if(mlink != "") this.d8 += '<a class=menu href="'+mlink+'">'; this.d8 += mtext; if(mlink != "") this.d8 += '</a>'; this.d8 += '</div></td></tr>'; }; }; POTMenu.prototype.addSubMenu=function(mid, submid, mtext, murl){ if(!c1[mid]) alert('No menu named '+mid+' has been defined.'); d6++; if(this.g4 != mid){ if(this.g4!=null){ var d1=((this.nomenus-1)*this.subspacery)+this.nomenus*this.subcheight; this.d7 += '</table></td><td><img src="'+this.f1+'" border="0" width="'+this.f1width+'" height="'+d1+'"></td></tr>'; this.d7 += '<tr><td colspan="3"><img src="'+this.h2+'" border="0" width="'+this.a2+'" height="'+this.g2+'">'; this.d7 += '<img src="'+this.h5+'" border="0" width="'+(this.subcwidth-this.subba)+'" height="'+this.g2+'">'; this.d7 += '<img src="'+this.h1+'" border="0" width="'+this.a1+'" height="'+this.g2+'"></td></tr></table>'; if(ns) this.d7 += '</layer>'; else this.d7 += '</div>'; this.d7=this.d7.replace("imgplaceholder", d1-this.d9); this.nomenus=0; } menuid++; this.g4=mid; if(ie) this.d7 += '<div class=menu id="vrsub'+menuid+'" onMouseover="a6('+menuid+','+d6+')" onmouseout="c2[c3['+d6+'].d4].b4=0" style="position:absolute; z-index:2; visibility: hidden;">'; else if(ns6) this.d7 += '<div class=menu id="vrsub'+menuid+'" onMouseover="a6('+menuid+','+d6+')" onmouseout="c2[c3['+d6+'].d4].b4=0" style="position:absolute; z-index:2; top:-400px;left:-400px;visibility: hidden;">'; else if(ns) this.d7 += '<layer id="vrsub'+menuid+'" onMouseover="a6('+menuid+','+d6+')" onMouseout="c2[c3['+d6+'].d4].b4=0" visibility="hide">'; this.d7 += '<table border="0" cellspacing="0" cellpadding="0"><tr><td colspan="3">'; this.d7 += '<img src="'+this.h4+'" border="0" width="'+this.a2+'" height="'+this.g2+'">'; this.d7 += '<img src="'+this.h6+'" border="0" width="'+(this.subcwidth-this.subba)+'" height="'+this.g2+'">'; this.d7 += '<img src="'+this.h3+'" border="0" width="'+this.a1+'" height="'+this.g2+'"></td></tr><tr><td>'; if(this.d9 !=0) this.d7 += '<img src="'+this.f2+'" border="0" width="'+this.h8+'" height="'+this.d9+'"><br>'; this.d7 += '<img src="'+this.h9+'" border="0" width="'+this.h8+'" height="imgplaceholder"></td><td><table border="0" cellspacing="0" cellpadding="0">'; } else{ if(this.subspacery>0){ this.d7 += '<tr><td width="'+this.subcwidth+'" height="'+this.subspacery+'">'; this.d7 += '<img border="0" src="'+this.subspacer+'" width="'+this.subcwidth+'" height="'+this.subspacery+'">'; this.d7 += '</td></tr>'; } } this.d7 += '<tr><td id="td'+d6+'" '+(ns6?'valign="bottom" ':'')+'class=menu width="'+this.subcwidth+'" height="'+this.subcheight+'" bgcolor="'+this.subcbgcolor+'">'; if(ie){ this.d7 += '<div class=menu id="imx'+d6+'" onMouseover="a4('+d6+')" onMouseout="zeroinitem('+d6+');c6('+d6+','+this.menudelay+')" STYLE="position:relative; width:'+this.subcwidth+'; z-index: 6">'; this.d7 += '<img align="absmiddle" border="0" src="'+this.subpreim+'" width="'+this.subpreimx+'" height="'+this.subpreimy+'">'; if(murl != "") this.d7 += '<a class=menu href="'+murl+'">'; this.d7 += mtext; if(murl != "") this.d7 += '</a>'; this.d7 += '</div>'; } else if(ns6){ this.d7 += '<div class=menu id="noimx'+d6+'" onMouseover="a4('+d6+')" onMouseout="zeroinitem('+d6+');c6('+d6+','+this.menudelay+')" STYLE="position:relative; width:'+this.subcwidth+'px;">'; this.d7 += '<img align="absmiddle" border="0" src="'+this.subpreim+'" width="'+this.subpreimx+'" height="'+this.subpreimy+'">'; if(murl != "") this.d7 += '<a class=menu href="'+murl+'">'; this.d7 += mtext; if(murl != "") this.d7 += '</a>'; this.d7 += '</div>'; } else{ this.d7 += '<ilayer id="imx'+d6+'"><layer class=menu width="'+this.subcwidth+'" height="'+this.subcheight+'" onMouseover="a4('+d6+')" onMouseout="zeroinitem('+d6+');c6('+d6+','+this.menudelay+')">'; if(this.nnsubheight > 0) this.d7 += '<img align="textbottom" border="0" src="'+this.mainpreim+'" width="'+this.g3+'" height="'+this.nnsubheight+'"><br>'; this.d7 += '&nbsp;'; if(murl != "") this.d7 += '<a class=menu href="'+murl+'">'+mtext+'</a>'; else this.d7 += mtext;this.d7 += '</layer></ilayer>'; }; this.d7 += '</td></tr>'; if(submid!="") c1[submid]=d6; c3[d6]=new d3(this.f3,c1[mid],menuid,0,this.nomenus); c3[c1[mid]].subitem=d6; c3[c1[mid]].submenu=menuid; c2[this.f3].mainmenulist[mid]=menuid; c3[d6].d1=this.subcheight+this.subspacery; c3[d6].d2=this.subcwidth; c3[d6].b1=this.g2; c3[d6].a8=this.f1width; c3[d6].a9=this.h8; c3[d6].c7=this.subcbgcolor; c3[d6].c5=this.subcbgcolorov; this.nomenus++; }; POTMenu.prototype.startMenu=function(){ defineglobals(); c2[c2ref]=new a0(); this.f3=c2ref; c2ref++; menuid++; c2[this.f3].b2=this.b2; c2[this.f3].b3=this.b3; c2[this.f3].hideselect=this.hideselect; c2[this.f3].hideobject=this.hideobject; this.rootmenu=menuid; this.firstmenuitem=d6+1; if(this.maincbgcolorov=='')this.maincbgcolorov=this.maincbgcolor; if(this.subcbgcolorov=='')this.subcbgcolorov=this.subcbgcolor; c2[this.f3].b8=this.firstmenuitem; if(opera) this.d8 += '<div id="vrsub'+menuid+'" STYLE="position:relative;">'; else if(ie){ if(ismac) this.d8 += '<div id="theroot" STYLE="position:absolute; visibility: hidden;">'; this.d8 += '<div id="vrsub'+menuid+'" STYLE="position:absolute; visibility: hidden;">'; } else if(ns6){ this.d8 += '<div id="vrsub'+menuid+'" STYLE="position:absolute; visibility: hidden;">'; } else if(ns){ this.d8 += '<ilayer id="vrsub'+menuid+'" visibility="show"><layer>'; }; this.d8 += '<table border="0" cellspacing="0" cellpadding="0"><tr><td colspan="3">'; this.d8 += '<img src="'+this.f7+'" border="0" width="'+this.imgcornerleft+'" height="'+this.imgheight+'">'; this.d8 += '<img src="'+this.imgtop+'" border="0" width="'+(this.g3-this.mainba)+'" height="'+this.imgheight+'">'; this.d8 += '<img src="'+this.f6+'" border="0" width="'+this.imgcornerright+'" height="'+this.imgheight+'"></td></tr><tr><td>'; this.d8 += '<img src="'+this.imgleft+'" border="0" width="'+this.f8+'" height="imgplaceholder">'; this.d8 += '</td><td><table border="0" cellspacing="0" cellpadding="0">'; }; POTMenu.prototype.showMainMenu=function(){ var d1=((this.nomenus-1)*this.mainspacery)+this.nomenus*this.g1; this.d8 += '</table></td><td><img src="'+this.imgright+'" border="0" width="'+this.f9+'" height="'+d1+'"></td></tr>'; this.d8 += '<tr><td colspan="3"><img src="'+this.f5+'" border="0" width="'+this.imgcornerleft+'" height="'+this.imgheight+'">'; this.d8 += '<img src="'+this.imgbottom+'" border="0" width="'+(this.g3-this.mainba)+'" height="'+this.imgheight+'">'; this.d8 += '<img src="'+this.f4+'" border="0" width="'+this.imgcornerright+'" height="'+this.imgheight+'"></td></tr></table>'; if(ie||ns6) this.d8 += '</div>'; else if(ns) this.d8 += '</layer></ilayer>'; document.write(this.d8.replace("imgplaceholder", d1)); this.nomenus=0; }; POTMenu.prototype.showMenu=function(){ var d1=((this.nomenus-1)*this.subspacery)+this.nomenus*this.subcheight; this.d7 += '</table></td><td><img src="'+this.f1+'" border="0" width="'+this.f1width+'" height="'+d1+'"></td></tr>'; this.d7 += '<tr><td colspan="3"><img src="'+this.h2+'" border="0" width="'+this.a2+'" height="'+this.g2+'"><img src="'+this.h5+'" border="0" width="'+(this.subcwidth-this.subba)+'" height="'+this.g2+'"><img src="'+this.h1+'" border="0" width="'+this.a1+'" height="'+this.g2+'"></td></tr></table>'; if(ie){ this.d7 += '</div>'; if(ismac) this.d7 += '</div>'; } else if(ns6){ this.d7 += '</div>'; } else if(ns) this.d7 += '</layer>'; document.write(this.d7.replace("imgplaceholder", d1-this.d9)); c2[this.f3].b9=d6; c1=new Array(); showrootmenu(this.rootmenu); }; POTMenu.prototype.mainmenuitemsize=function(width,height){ this.g3=width; this.g1=height; this.mainpreimy=height-3; }; POTMenu.prototype.submenuitemsize=function(width,height){ this.subcwidth=width; this.subcheight=height; this.subpreimy=height-3; }; POTMenu.prototype.submenuplacing=function(b2,b3){ this.b2=Math.abs(b2); this.b3=b3; }; POTMenu.prototype.mainborderimages=function(left,right,top,bottom){ this.imgleft=left; this.imgright=right; this.imgtop=top; this.imgbottom=bottom; }; POTMenu.prototype.mainbordercorners=function(topleft,topright,bottomleft,bottomright){ this.f7=topleft; this.f6=topright; this.f5=bottomleft; this.f4=bottomright; }; POTMenu.prototype.mainborderdimensions=function(leftwidth,rightwidth,height){ this.imgcornerleft=this.f8=leftwidth; this.imgcornerright=this.f9=rightwidth; this.imgheight=height; this.mainba=0; }; POTMenu.prototype.subborderimages=function(left,right,top,bottom){ this.h9=left; this.f1=right; this.h6=top; this.h5=bottom; }; POTMenu.prototype.subbordercorners=function(topleft,topright,bottomleft,bottomright){ this.h4=topleft; this.h3=topright; this.h2=bottomleft; this.h1=bottomright; }; POTMenu.prototype.subborderdimensions=function(leftwidth,rightwidth,height){ this.a2=this.h8=leftwidth; this.a1=this.f1width=rightwidth; this.g2=height; this.subba=0; }; POTMenu.prototype.definejoin=function(join,joinheight){ this.f2=join; this.d9=joinheight; }; POTMenu.prototype.maincornerwidths=function(leftwidth,rightwidth){ this.imgcornerleft=leftwidth; this.imgcornerright=rightwidth; this.mainba=(leftwidth+rightwidth)-(this.f8+this.f9); }; POTMenu.prototype.subcornerwidths=function(leftwidth,rightwidth){ this.a2=leftwidth; this.a1=rightwidth; this.subba=(leftwidth+rightwidth)-(this.h8+this.f1width); }; POTMenu.prototype.mainmenucolor = function(bgcolor){ this.maincalign = "left"; this.maincbgcolor = bgcolor; }; POTMenu.prototype.mainmenucolorov = function(bgcolorov){ this.maincbgcolorov = bgcolorov; }; POTMenu.prototype.submenucolor = function(bgcolor){ this.subcalign = "left"; this.subcbgcolor = bgcolor; }; POTMenu.prototype.submenucolorov = function(bgcolorov){ this.subcbgcolorov = bgcolorov; }; POTMenu.prototype.mainpreimage = function(pim,pio,pix,piy){ this.mainpreim = pim; this.mainpreimov = pio; this.mainpreimx = pix; this.mainpreimy = piy; }; POTMenu.prototype.subpreimage = function(pim,pio,pix,piy){ this.subpreim = pim; this.subpreimov = pio; this.subpreimx = pix; this.subpreimy = piy; }; POTMenu.prototype.definemainspacer = function(name,height){ this.mainspacer = name; this.mainspacery = height; }; POTMenu.prototype.definesubspacer = function(name,height){ this.subspacer = name; this.subspacery = height; }; POTMenu.prototype.netscapeadjust = function(main,sub){ this.nnmainheight = main; this.nnsubheight = sub; }; POTMenu.prototype.hideobjects = function(bSelect,bObject){ this.hideselect = bSelect; this.hideobject = bObject; }; POTMenu.prototype.setdelay = function(iDelay){ this.menudelay = iDelay; }; this.mainmenuitemsize(160,30); this.submenuitemsize(100,30); this.submenuplacing(0,0); this.mainborderdimensions(1,1,1); this.subborderdimensions(1,1,1); this.mainborderimages("clearpixel.gif","clearpixel.gif","clearpixel.gif","clearpixel.gif"); this.mainbordercorners("clearpixel.gif","clearpixel.gif","clearpixel.gif","clearpixel.gif"); this.subborderimages("clearpixel.gif","clearpixel.gif","clearpixel.gif","clearpixel.gif"); this.subbordercorners("clearpixel.gif","clearpixel.gif","clearpixel.gif","clearpixel.gif"); this.definejoin("",0); this.mainpreimage("clearpixel.gif","clearpixel.gif",5,27); this.subpreimage("clearpixel.gif","clearpixel.gif",5,27); this.definemainspacer("",0); this.definesubspacer("",0); this.g4=null; this.d8=""; this.d7=""; this.nomenus=0; this.netscapeadjust(0,0); this.hideselect=false; this.hideobject=false; this.menudelay=600; c0=false; } 